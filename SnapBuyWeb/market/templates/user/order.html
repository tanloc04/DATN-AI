{% extends 'base_user.html' %}
{% block title %}Đơn hàng của bạn{% endblock %}

{% block content %}

<style>
  .table th, .table td {
    vertical-align: middle;
  }
</style>

<div class="container mt-5">
  <div class="card shadow-sm border-0 rounded-4">
    <div class="card-body">
      <h3 class="text-center mb-4 text-primary fw-bold">
        <i class="bi bi-bag-check me-2"></i>Đơn hàng của bạn
      </h3>

      {% if orders %}
        <div class="table-responsive">
          <table class="table table-bordered align-middle text-center table-hover">
            <thead class="table-light">
              <tr>
                <th>Sản phẩm</th>
                <th>Giá</th>
                <th>Số lượng</th>
                <th>Tổng tiền</th>
                <th>Ngày đặt</th>
                <th>Trạng thái</th>
                <th>Hành động</th>
              </tr>
            </thead>
            <tbody>
              {% for order in orders %}
              <tr>
                <td class="fw-semibold">{{ order.item.name }}</td>
                <td class="text-nowrap text-success">{{ "{:,.0f}".format(order.item.price) }} đ</td>
                <td>{{ order.quantity }}</td>
                <td class="fw-bold text-primary">{{ "{:,.0f}".format(order.total_price) }} đ</td>
                <td>{{ order.created_at.strftime('%d/%m/%Y') }}</td>
                <td>
  {% if order.status == 'delivered' %}
    <span class="badge bg-success">Đã giao</span>
  {% else %}
    <span class="badge bg-warning text-dark">Đang giao</span>
  {% endif %}
</td>
<td>
  {% if order.status == 'processing' %}
    <form action="{{ url_for('confirm_order', order_id=order.id) }}" method="post" style="display: inline;">
      <button class="btn btn-outline-success btn-sm rounded-pill" type="submit">
        <i class="bi bi-check-circle me-1"></i>Đã nhận
      </button>
    </form>
  {% elif order.status == 'delivered' %}
    <a href="{{ url_for('rate_order', order_id=order.id) }}" class="btn btn-outline-primary btn-sm rounded-pill">
      <i class="bi bi-star me-1"></i>Đánh giá
    </a>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="text-center py-5">
          <i class="bi bi-bag-x fs-1 text-muted"></i>
          <p class="mt-3 fs-5">Bạn chưa có đơn hàng nào.</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
